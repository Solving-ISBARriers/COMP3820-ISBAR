(this["webpackJsonpisbar-complex-react"]=this["webpackJsonpisbar-complex-react"]||[]).push([[0],{386:function(e,t,n){},442:function(e,t){},444:function(e,t){},485:function(e,t){},486:function(e,t){},581:function(e,t,n){},583:function(e,t,n){"use strict";n.r(t);var i=n(1),a=n.n(i),r=n(110),s=n.n(r),c=(n(386),n(27)),o=n(28),l=n(33),u=n(32),d=n(357),h=n(47),j=n(157),p=n(2),b=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"componentDidMount",value:function(){j.oauth2.authorize({clientId:"my-client-id",scope:"launch openid fhirUser patient/*.read patient/*.write",redirectUri:"./isbar-app",iss:"https://launch.smarthealthit.org/v/r3/sim/eyJoIjoiMSIsImIiOiJmMDQ2MjkzNi1lYjRiLTRkYTEtYjQ1YS1mYmQ5NmViZjhjY2IiLCJlIjoic21hcnQtUHJhY3RpdGlvbmVyLTcxNjE0NTAyIn0/fhir",completeInTarget:!0})}},{key:"render",value:function(){return Object(p.jsx)("div",{className:"loading-container",children:"Launching the ISBAR handover form.."})}}]),n}(a.a.Component),O=n(106),f=a.a.createContext({}),x=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var i;return Object(c.a)(this,n),(i=t.call(this,e)).state={client:null,error:null,simpleForms:null,complexForms:null},i}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=this;j.oauth2.ready().then((function(t){return e.setState({client:t})}),(function(t){return e.setState({error:t})}))}},{key:"render",value:function(){var e=this;return Object(p.jsx)(f.Provider,{value:this.state||{},children:Object(p.jsx)(f.Consumer,{children:function(t){var n=t.client,i=t.error;return console.log("Client"),console.log(n),i?Object(p.jsx)("pre",{children:i.stack}):n?e.props.children:Object(p.jsx)("div",{className:"loading-container",children:"Launching the ISBAR handover form.."})}})})}}]),n}(a.a.Component),m=n(49),v=m.d.create({page:{backgroundColor:"#FFFFFF",margin:10,padding:20},section:{margin:15},heading:{fontSize:"16pt"}}),y=function(e){var t=["N/A","N/A","N/A","N/A","N/A"];return e.content.item.forEach((function(e,n){"undefined"!==typeof e.answer&&(t[n]=e.answer[0].valueString)})),Object(p.jsx)(m.a,{children:Object(p.jsxs)(m.c,{size:"A4",style:v.page,children:[Object(p.jsxs)(m.f,{style:v.section,children:[Object(p.jsx)(m.e,{style:v.heading,children:"I: Introduction"}),Object(p.jsx)(m.e,{children:t[0]})]}),Object(p.jsxs)(m.f,{style:v.section,children:[Object(p.jsx)(m.e,{style:v.heading,children:"S: Situation"}),Object(p.jsx)(m.e,{children:t[1]})]}),Object(p.jsxs)(m.f,{style:v.section,children:[Object(p.jsx)(m.e,{style:v.heading,children:"B: Background"}),Object(p.jsx)(m.e,{children:t[2]})]}),Object(p.jsxs)(m.f,{style:v.section,children:[Object(p.jsx)(m.e,{style:v.heading,children:"A: Assessment"}),Object(p.jsx)(m.e,{children:t[3]})]}),Object(p.jsxs)(m.f,{style:v.section,children:[Object(p.jsx)(m.e,{style:v.heading,children:"R: Recommendation"}),Object(p.jsx)(m.e,{children:t[4]})]})]})})},g=n(265),S=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var i;return Object(c.a)(this,n),(i=t.call(this,e)).state={value:"",timeout:null,delay:5e3},i.handleChange=i.handleChange.bind(Object(O.a)(i)),i}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.setState({value:this.props.initialValue})}},{key:"componentWillUnmount",value:function(){clearTimeout(this.state.timeout)}},{key:"handleChange",value:function(e){var t=this;this.setState({value:e.target.value}),clearTimeout(this.state.timeout),this.setState({timeout:setTimeout((function(){t.props.updateField(t.state.value)}),this.state.delay)})}},{key:"render",value:function(){return this.props.visible?Object(p.jsx)(g.a,{fullWidth:!0,multiline:!0,placeholder:this.props.placeholder,value:this.state.value,onChange:this.handleChange}):Object(p.jsx)(g.a,{fullWidth:!0,multiline:!0,placeholder:this.props.placeholder,value:this.state.value,onChange:this.handleChange,sx:{display:"none"}})}}]),n}(a.a.Component),k=n(648),I=n(654),C=n(652),F=n(595),N=n(591),w=n(263),A=n(649),R=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var i;return Object(c.a)(this,n),(i=t.call(this,e)).state={answerSet:[],value:""},i}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.updatAnswerSet()}},{key:"updatAnswerSet",value:function(){var e=this,t=this.props.resourceName+"?";this.props.query.forEach((function(e,n){t=0===n?"?"+t:":"+t,t+=e})),this.context.client.request(t).then((function(t){t.entry.forEach((function(e){})),e.setState({answerSet:[]})}))}},{key:"render",value:function(){return Object(p.jsx)(A.a,{id:this.props.id,options:this.state.answerSet,renderInput:function(e){return Object(p.jsx)(g.a,Object(w.a)(Object(w.a)({},e),{},{label:"input"}))}})}}]),n}(a.a.Component);R.contextType=f;var D=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var i;return Object(c.a)(this,n),(i=t.call(this,e)).state={loaded:!1,content:null,isIsobar:!1,isNew:!1,uploaded:!0,practitioners:[]},i.updateFieldValue=i.updateFieldValue.bind(Object(O.a)(i)),i}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e,t,n,i=this;if(console.log(this.props.create),this.props.create){var a=(e=this.props.questionnaireID,t=this.context.client.patient.id,n=this.context.client.user.id,{resourceType:"QuestionnaireResponse",text:{name:"isbar handover form"},questionnaire:"Questionnaire/"+e,status:"in-progress",subject:{reference:"Patient/"+t},author:{reference:"Practitioner/"+n},item:[{linkId:"1",text:"I:Identify"},{linkId:"2",text:"S:Situation"},{linkId:"3",text:"O:Observation"},{linkId:"4",text:"B:Background"},{linkId:"5",text:"A:Assessment"},{linkId:"6",text:"R:Recommendation"}]});this.context.client.create(a).then((function(e){i.setState({content:e,loaded:!0})}))}else this.context.client.request("QuestionnaireResponse/"+this.props.formID).then((function(e){return i.setState({content:e,loaded:!0})}));this.getAllPractitioner()}},{key:"componentDidUpdate",value:function(){this.uploadToServer()}},{key:"uploadToServer",value:function(){var e=this;this.state.uploaded||this.context.client.update(this.state.content).then((function(t){e.setState({uploaded:!0}),console.log(t)}))}},{key:"getFieldValue",value:function(e){return this.state.content.item[e].hasOwnProperty("answer")?this.state.content.item[e].answer[0].valueString:""}},{key:"getAllPractitioner",value:function(){var e=this;this.context.client.request("Practitioner",{pageLimit:0}).then((function(t){var n=[];t.forEach((function(e){e.entry.forEach((function(e){n.push(e)}))})),console.log(n),e.setState({practitioners:n}),console.log(t)}))}},{key:"updateFieldValue",value:function(e,t){var n=this.state.content;n.item[t].hasOwnProperty("answer")?n.item[t].answer[0].valueString=e:n.item[t].answer=[{valueString:e}],this.setState({content:n,uploaded:!1})}},{key:"render",value:function(){var e=this;return this.state.loaded?Object(p.jsxs)(k.a,{spacing:2,sx:{padding:"5% 3% 5% 3%"},children:[Object(p.jsx)(I.a,{variant:"h2",children:"Simple ISBAR Form"}),Object(p.jsxs)(C.a,{children:[Object(p.jsx)(F.a,{value:"ISOBAR",control:Object(p.jsx)(N.a,{}),label:"ISOBAR",labelPlacement:"start",onChange:function(t){return e.setState({isIsobar:t.target.checked})}}),Object(p.jsx)(R,{resourceName:"Practitioner",query:[]})]}),Object(p.jsx)(S,{initialValue:this.getFieldValue(0),placeholder:"Introduction",visible:!0,updateField:function(t){return e.updateFieldValue(t,0)}}),Object(p.jsx)(S,{initialValue:this.getFieldValue(1),placeholder:"Situation",visible:!0,updateField:function(t){return e.updateFieldValue(t,1)}}),Object(p.jsx)(S,{initialValue:this.getFieldValue(2),placeholder:"Observation",visible:this.state.isIsobar,updateField:function(t){return e.updateFieldValue(t,2)}}),Object(p.jsx)(S,{initialValue:this.getFieldValue(3),placeholder:"Background",visible:!0,updateField:function(t){return e.updateFieldValue(t,3)}}),Object(p.jsx)(S,{initialValue:this.getFieldValue(4),placeholder:"Assessment",visible:!0,updateField:function(t){return e.updateFieldValue(t,4)}}),Object(p.jsx)(S,{initialValue:this.getFieldValue(5),placeholder:"Recommendation",visible:!0,updateField:function(t){return e.updateFieldValue(t,5)}}),Object(p.jsx)("button",{className:"isbar-save",children:Object(p.jsx)(m.b,{document:Object(p.jsx)(y,{content:this.state.content}),fileName:"isbar.pdf",children:function(e){e.blob,e.url;var t=e.loading;e.error;return t?"Preparing":"Print"}})})]}):Object(p.jsx)("div",{className:"loading-container",children:"Creating new form.."})}}]),n}(a.a.Component);D.contextType=f;var P=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e)}return Object(o.a)(n,[{key:"render",value:function(){return Object(p.jsx)("div",{children:"Assessment"})}}]),n}(a.a.Component),V=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e)}return Object(o.a)(n,[{key:"render",value:function(){return Object(p.jsx)("div",{children:"Background"})}}]),n}(a.a.Component),T=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e)}return Object(o.a)(n,[{key:"render",value:function(){return Object(p.jsx)("div",{children:"Introduction is changed"})}}]),n}(a.a.Component),B=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e)}return Object(o.a)(n,[{key:"render",value:function(){return Object(p.jsx)("div",{class:"container  mx-auto px-10 sm:px-8 max-w-7xl py-10",children:Object(p.jsx)("sl-form",{children:Object(p.jsx)("sl-textarea",{rows:4})})})}}]),n}(a.a.Component),M=n(12),q=n(655),L=n(266),E=n(78),Q=n(170),U=n(203);function W(){var e=a.a.useState(""),t=Object(M.a)(e,2),n=t[0],i=t[1];return Object(p.jsx)(q.a,{sx:{minWidth:120},children:Object(p.jsxs)(Q.a,{fullWidth:!0,children:[Object(p.jsx)(L.a,{id:"airwaySelect",children:"Airway"}),Object(p.jsxs)(U.a,{labelId:"Airway",id:"airwaySelect",value:n,label:"Options",onChange:function(e){i(e.target.value)},children:[Object(p.jsx)(E.a,{value:10,children:"Patent"}),Object(p.jsx)(E.a,{value:20,children:"Compromised"}),Object(p.jsx)(E.a,{value:30,children:"Ventilated"})]})]})})}var Y=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var i;return Object(c.a)(this,n),(i=t.call(this,e)).state={loaded:!1,error:null,responseExist:!1,patient:null,questionnaire:null,questionnaireResponse:null,isIsobar:!1,saveState:"edited",formState:"ISOBAR"},i}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.context.client}},{key:"render",value:function(){return Object(p.jsxs)("div",{className:"container  mx-auto px-10 sm:px-8 max-w-7xl py-10",children:[Object(p.jsx)("h1",{children:"Situation"}),Object(p.jsx)("h3",{children:"Patient Status"}),Object(p.jsx)(g.a,{fullWidth:!0,multiline:!0,placeholder:"Patient Status"}),Object(p.jsx)("h3",{children:"Principle Diagnosis"}),Object(p.jsx)(g.a,{fullWidth:!0,multiline:!0,placeholder:"Principle Diagnosis"}),Object(p.jsx)("h3",{children:"Other Diagnosis/problems"}),Object(p.jsx)(g.a,{fullWidth:!0,multiline:!0,placeholder:"Other Diagnosis/problems"}),Object(p.jsx)("h3",{children:"Reason For transfer"}),Object(p.jsx)(g.a,{fullWidth:!0,multiline:!0,placeholder:"Reason For transfer"}),Object(p.jsx)("h3",{children:"Observations"}),Object(p.jsx)(W,{})]})}}]),n}(a.a.Component);Y.contextType=f;var z=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object(p.jsx)("div",{className:"app-complex",children:Object(p.jsxs)("div",{className:"container",children:[Object(p.jsx)("h2",{className:"section-title",children:"Introduction"}),Object(p.jsx)(T,{}),Object(p.jsx)("h2",{className:"section-title",children:"Situation"}),Object(p.jsx)(Y,{}),Object(p.jsx)("h2",{className:"section-title",children:"Background"}),Object(p.jsx)(V,{}),Object(p.jsx)("h2",{className:"section-title",children:"Assessment"}),Object(p.jsx)(P,{}),Object(p.jsx)("h2",{className:"section-title",children:"Recommendation"}),Object(p.jsx)(B,{})]})})}}]),n}(a.a.Component),J=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e)}return Object(o.a)(n,[{key:"render",value:function(){switch(this.props.current){case"I":return Object(p.jsx)(T,{});case"S":return Object(p.jsx)(Y,{});case"B":return Object(p.jsx)(V,{});case"A":return Object(p.jsx)(P,{});case"R":return Object(p.jsx)(B,{});default:return Object(p.jsx)(T,{})}}}]),n}(a.a.Component);(function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var i;return Object(c.a)(this,n),(i=t.call(this,e)).state={current:"I",loaded:!1,carePlan:null},i}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.context.client;this.LoadCarePlan().then((function(t){console.log(t),e.setState({loaded:!0})}))}},{key:"LoadCarePlan",value:function(){return this.context.client.request("CarePlan?patient="+this.context.client.patient.id).then((function(e){}))}},{key:"render",value:function(){var e=this;return this.state.loaded?Object(p.jsxs)("div",{className:"app-complex",children:[Object(p.jsx)("div",{className:"app-content",children:Object(p.jsx)(J,{current:this.state.current})}),Object(p.jsxs)("div",{className:"footer",children:[Object(p.jsx)("div",{className:"arrow",children:"\u2190"}),Object(p.jsx)("button",{className:"nav-button",onClick:function(){return e.setState({current:"I"})},children:"I"}),Object(p.jsx)("button",{className:"nav-button",onClick:function(){return e.setState({current:"S"})},children:"S"}),Object(p.jsx)("button",{className:"nav-button",onClick:function(){return e.setState({current:"B"})},children:"B"}),Object(p.jsx)("button",{className:"nav-button",onClick:function(){return e.setState({current:"A"})},children:"A"}),Object(p.jsx)("button",{className:"nav-button",onClick:function(){return e.setState({current:"R"})},children:"R"}),Object(p.jsx)("div",{className:"arrow",children:"\u2192"})]})]}):Object(p.jsx)("div",{children:"Loading complex isbar form..."})}}]),n}(a.a.Component)).contextType=f;var H=n(651),G=n(656),Z=n(124),K=n(657),X=n(356),$=n.n(X),_=n(355);function ee(e){return e.prefix[0]?e.prefix[0]+" "+e.given[0]+" "+e.family:e.given[0]+" "+e.family}var te=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var i;return Object(c.a)(this,n),(i=t.call(this,e)).state={fields:[{field:"lastUpdated",headerName:"Last Updated",description:"Time last updated",flex:2},{field:"id",headerName:"ID",description:"Form ID",flex:2},{field:"author",headerName:"Author",description:"Author of the form",flex:3},{field:"recipient",headerName:"Recipient",description:"Receiving party of the form",flex:3},{field:"action",headerName:"Action",description:"Actions allowed on the form",cellClassName:"simple-table--cell",align:"center",headerAlign:"center",width:100}],entries:null},i}return Object(o.a)(n,[{key:"componentDidMount",value:function(){console.log("history"),console.log(this.props.data),this.props.data?this.updateTable():console.error("No data given to history!! did the request fail?")}},{key:"updateTable",value:function(){var e=this,t=[];0!=this.props.data.total?(this.props.data.entry.forEach((function(e){var n=e.resource,i={lastUpdated:"Loading",id:"Loading",author:"Loading",recipient:"Loading",action:null};n.meta.hasOwnProperty("lastUpdated")&&(i.lastUpdated=function(e){var t=new Date(e);return t.getFullYear()+"-"+t.getMonth()+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()}(n.meta.lastUpdated)),n.hasOwnProperty("id")&&(i.id=n.id),n.hasOwnProperty("author")&&(i.author=ee(n.author.name[0])),i.action="EDIT",t.push(i)})),this.props.data.entry.forEach((function(n,i){var a=n.resource;a.hasOwnProperty("extension")&&e.context.client.request(a.extension[0].valueReference.reference).then((function(n){console.log(t[i]),t[i].recipient=ee(n.name[0]),e.forceUpdate()}))}))):console.log("no existing entry"),this.setState({entries:t})}},{key:"handleCellClick",value:function(e){"action"===e.colDef.field&&this.props.editForm(e.id)}},{key:"render",value:function(){var e=this;return null!=this.state.entries?Object(p.jsx)("div",{style:{height:400,width:"100%"},children:Object(p.jsx)(_.a,{rows:this.state.entries,columns:this.state.fields,pageSize:5,rowsPerPageOptions:[5],disableColumnMenu:!0,disableSelectionOnClick:!0,onCellClick:function(t){"action"===t.colDef.field&&e.props.editForm(t.id)}})}):Object(p.jsx)("div",{children:"Loading data.."})}}]),n}(a.a.Component);te.contextType=f;var ne=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object(p.jsx)(x,{children:Object(p.jsx)(ie,{})})}}]),n}(a.a.Component),ie=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var i;return Object(c.a)(this,n),(i=t.call(this,e)).state={loaded:!1,isMenu:!0,isSimple:!0,questionnaireID:null,simpleResponses:null,createNew:!1,simpleFormID:null},i.editSimpleForm=i.editSimpleForm.bind(Object(O.a)(i)),i}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.loadQuestionnaireID().then((function(t){return e.loadSimpleIsbars(t)})).then((function(){return e.setState({loaded:!0})}));Promise.all([t]).then((function(){return console.log("all loaded")}))}},{key:"backToMenu",value:function(){this.setState({isMenu:!0})}},{key:"loadQuestionnaireID",value:function(){var e=this;return this.context.client.request("Questionnaire?name="+ae.name).then((function(t){return 0===t.total?e.context.client.create(ae):t.entry[0].resource})).then((function(t){return e.setState({questionnaireID:t.id}),t.id})).catch(console.error)}},{key:"loadSimpleIsbars",value:function(e){var t=this;return this.context.client.request("QuestionnaireResponse?questionnaire="+e+"&patient=Patient/"+this.context.client.patient.id,{resolveReferences:["author"]}).then((function(e){return t.setState({simpleResponses:e}),e})).catch(console.error)}},{key:"editSimpleForm",value:function(e){var t=this.state.simpleResponses.entry.filter((function(t){return t.resource.id===e}));console.log(t),console.log(t[0].resource.id),this.setState({simpleFormID:t[0].resource.id,isMenu:!1,isSimple:!0,createNew:!1})}},{key:"render",value:function(){var e=this;return this.state.loaded&&this.state.isMenu?Object(p.jsxs)("div",{children:[Object(p.jsxs)(q.a,{sx:{padding:"3%"},children:[Object(p.jsx)(I.a,{sx:{width:"100%",textAlign:"center",fontSize:"30px"},children:"ISBAR Handover Form"}),Object(p.jsx)(k.a,{spacing:2,sx:{},children:Object(p.jsxs)(H.a,{defaultExpanded:!1,children:[Object(p.jsxs)(G.a,{expandIcon:Object(p.jsx)($.a,{}),"aria-controls":"panel1bh-content",id:"panel1bh-header",children:[Object(p.jsx)(I.a,{sx:{width:"70%",flexShrink:0},children:"Simple ISBAR handover forms"}),Object(p.jsx)(Z.a,{onClick:function(){return e.setState({createNew:!0,isMenu:!1,isSimple:!0})},children:"Create new"})]}),Object(p.jsx)(K.a,{children:Object(p.jsx)(te,{data:this.state.simpleResponses,editForm:function(t){return e.editSimpleForm(t)}})})]})})]}),Object(p.jsx)("button",{className:"main-menu-button",onClick:function(){return e.setState({isSimple:!1,isMenu:!1})},children:"Complex ISBAR"})]}):this.state.loaded&&this.state.isSimple?Object(p.jsx)(D,{goBack:this.backToMenu.bind(this),formID:this.state.simpleFormID,create:this.state.createNew,questionnaireID:this.state.questionnaireID}):this.state.loaded&&!this.state.isSimple?Object(p.jsx)(z,{}):Object(p.jsx)("div",{children:"Loading"})}}]),n}(a.a.Component);ie.contextType=f;var ae={resourceType:"Questionnaire",title:"questionnaireTitle",name:"isbar-simple",status:"active",item:[{linkid:"1",text:"I:Identify",type:"text"},{linkid:"2",text:"S:Situation",type:"text"},{linkid:"3",text:"O:Observation",type:"text"},{linkid:"4",text:"B:Background",type:"text"},{linkid:"5",text:"A:Assessment",type:"text"},{linkid:"6",text:"R:Recommendation",type:"text"}]},re=(n(581),function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object(p.jsx)(d.a,{children:Object(p.jsxs)(h.c,{children:[Object(p.jsx)(h.a,{path:"/isbar-app",component:ne,exact:!0}),Object(p.jsx)(h.a,{path:"/",component:b,exact:!0})]})})}}]),n}(a.a.Component));s.a.render(Object(p.jsx)(re,{}),document.getElementById("root"))}},[[583,1,2]]]);
//# sourceMappingURL=main.57c4dbfb.chunk.js.map