(this["webpackJsonpisbar-complex-react"]=this["webpackJsonpisbar-complex-react"]||[]).push([[0],{379:function(e,t,n){},435:function(e,t){},437:function(e,t){},478:function(e,t){},479:function(e,t){},574:function(e,t,n){},576:function(e,t,n){"use strict";n.r(t);var i=n(1),a=n.n(i),r=n(103),c=n.n(r),s=(n(379),n(27)),o=n(28),l=n(33),u=n(32),d=n(348),h=n(46),j=n(123),b=n(2),p=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"componentDidMount",value:function(){j.oauth2.authorize({clientId:"my-client-id",scope:"launch openid fhirUser patient/*.read patient/*.write",redirectUri:"/isbar-app",iss:"https://launch.smarthealthit.org/v/r3/sim/eyJoIjoiMSIsImIiOiJmMDQ2MjkzNi1lYjRiLTRkYTEtYjQ1YS1mYmQ5NmViZjhjY2IiLCJlIjoic21hcnQtUHJhY3RpdGlvbmVyLTcxNjE0NTAyIn0/fhir",completeInTarget:!0})}},{key:"render",value:function(){return Object(b.jsx)("div",{className:"loading-container",children:"Launching the ISBAR handover form.."})}}]),n}(a.a.Component),O=a.a.createContext({}),x=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var i;return Object(s.a)(this,n),(i=t.call(this,e)).state={client:null,error:null,simpleForms:null,complexForms:null},i}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=this;j.oauth2.ready().then((function(t){return e.setState({client:t})}),(function(t){return e.setState({error:t})}))}},{key:"render",value:function(){var e=this;return Object(b.jsx)(O.Provider,{value:this.state||{},children:Object(b.jsx)(O.Consumer,{children:function(t){var n=t.client,i=t.error;return console.log("Client"),console.log(n),i?Object(b.jsx)("pre",{children:i.stack}):n?e.props.children:Object(b.jsx)("div",{className:"loading-container",children:"Launching the ISBAR handover form.."})}})})}}]),n}(a.a.Component),f=n(182),m=n(48),v=m.d.create({page:{backgroundColor:"#FFFFFF",margin:10,padding:20},section:{margin:15},heading:{fontSize:"16pt"}}),g=function(e){var t=["N/A","N/A","N/A","N/A","N/A"];return e.content.item.forEach((function(e,n){"undefined"!==typeof e.answer&&(t[n]=e.answer[0].valueString)})),Object(b.jsx)(m.a,{children:Object(b.jsxs)(m.c,{size:"A4",style:v.page,children:[Object(b.jsxs)(m.f,{style:v.section,children:[Object(b.jsx)(m.e,{style:v.heading,children:"I: Introduction"}),Object(b.jsx)(m.e,{children:t[0]})]}),Object(b.jsxs)(m.f,{style:v.section,children:[Object(b.jsx)(m.e,{style:v.heading,children:"S: Situation"}),Object(b.jsx)(m.e,{children:t[1]})]}),Object(b.jsxs)(m.f,{style:v.section,children:[Object(b.jsx)(m.e,{style:v.heading,children:"B: Background"}),Object(b.jsx)(m.e,{children:t[2]})]}),Object(b.jsxs)(m.f,{style:v.section,children:[Object(b.jsx)(m.e,{style:v.heading,children:"A: Assessment"}),Object(b.jsx)(m.e,{children:t[3]})]}),Object(b.jsxs)(m.f,{style:v.section,children:[Object(b.jsx)(m.e,{style:v.heading,children:"R: Recommendation"}),Object(b.jsx)(m.e,{children:t[4]})]})]})})},y=n(256),k=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var i;return Object(s.a)(this,n),(i=t.call(this,e)).state={loaded:!1,content:null,isIsobar:!1,saved:!1},i.updateResponse=i.updateResponse.bind(Object(f.a)(i)),i}return Object(o.a)(n,[{key:"componentDidMount",value:function(){console.log(this.props.create),this.props.create?this.createSimpleIsbar().then(console.log).catch(console.error):this.setState({content:this.props.content}),this.context.client.user.read().then(console.log)}},{key:"updateResponse",value:function(e,t){var n=this.state.content;n.item[t].hasOwnProperty("answer")?n.item[t].answer[0].valueString=e.target.value:n.item[t].answer=[{valueString:e.target.value}],this.setState({content:n}),"saved"===this.state.saved&&this.setState({saved:"edited"})}},{key:"getFieldValue",value:function(e){return this.state.content.item[e].hasOwnProperty("answer")?this.state.content.item[e].answer[0].valueString:""}},{key:"createSimpleIsbar",value:function(){return this.context.client.create((e=this.props.questionnaireID,t=this.context.client.patient.id,n=this.context.client.user.id,{resourceType:"QuestionnaireResponse",text:{name:"isbar handover form"},questionnaire:"Questionnaire/"+e,status:"in-progress",subject:{reference:"Patient/"+t},author:{reference:"Practitioner/"+n},extension:[{url:"http://hl7.org/fhir/StructureDefinition/questionnaireresponse-reviewer",valueReference:{reference:"Practitioner/"+n}}],item:[{linkId:"1",text:"I:Identify"},{linkId:"2",text:"S:Situation"},{linkId:"3",text:"O:Observation"},{linkId:"4",text:"B:Background"},{linkId:"5",text:"A:Assessment"},{linkId:"6",text:"R:Recommendation"}]})).catch(console.error);var e,t,n}},{key:"render",value:function(){var e=this;return this.state.loaded?Object(b.jsxs)("div",{className:"container",children:[Object(b.jsxs)("div",{id:"simple-header",children:[Object(b.jsx)("button",{id:"go-back-button",onClick:this.props.goBack,children:" Back to Menu "}),Object(b.jsx)("h1",{children:"ISBAR"}),Object(b.jsxs)("div",{id:"simple-header-content",children:[Object(b.jsxs)("p",{className:"simple-state",children:["State:",this.state.saved]}),Object(b.jsxs)("label",{className:"simple-toggle",children:["Is ISOBAR:",Object(b.jsx)("input",{name:"isISOBAR",type:"checkbox",checked:this.state.isIsobar,onChange:function(){return e.setState((function(e){return{isIsobar:!e.isIsobar}}))}})]})]})]}),Object(b.jsx)(y.a,{fullWidth:!0,multiline:!0,placeholder:"Introduction",value:this.getFieldValue(0),onChange:function(t){return e.updateResponse(t,0)}}),Object(b.jsx)(y.a,{fullWidth:!0,multiline:!0,placeholder:"Situation",value:this.getFieldValue(1),onChange:function(t){return e.updateResponse(t,1)}}),Object(b.jsx)(y.a,{fullWidth:!0,multiline:!0,placeholder:"Observation",value:this.getFieldValue(2),onChange:function(t){return e.updateResponse(t,2)}}),Object(b.jsx)(y.a,{fullWidth:!0,multiline:!0,placeholder:"Background",value:this.getFieldValue(3),onChange:function(t){return e.updateResponse(t,3)}}),Object(b.jsx)(y.a,{fullWidth:!0,multiline:!0,placeholder:"Assessment",value:this.getFieldValue(4),onChange:function(t){return e.updateResponse(t,4)}}),Object(b.jsx)(y.a,{fullWidth:!0,multiline:!0,placeholder:"Recommendation",value:this.getFieldValue(5),onChange:function(t){return e.updateResponse(t,5)}}),Object(b.jsx)("button",{className:"isbar-save",onClick:function(){return e.updateResponse()},children:"Save"}),Object(b.jsx)("button",{className:"isbar-save",children:Object(b.jsx)(m.b,{document:Object(b.jsx)(g,{content:this.state.content}),fileName:"isbar.pdf",children:function(e){e.blob,e.url;var t=e.loading;e.error;return t?"Preparing":"Print"}})})]}):Object(b.jsx)("div",{className:"loading-container",children:"Loading simple ISBAR form..."})}}]),n}(a.a.Component);k.contextType=O;var S=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){return Object(s.a)(this,n),t.call(this,e)}return Object(o.a)(n,[{key:"render",value:function(){return Object(b.jsx)("div",{children:"Assessment"})}}]),n}(a.a.Component),I=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){return Object(s.a)(this,n),t.call(this,e)}return Object(o.a)(n,[{key:"render",value:function(){return Object(b.jsx)("div",{children:"Background"})}}]),n}(a.a.Component),R=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){return Object(s.a)(this,n),t.call(this,e)}return Object(o.a)(n,[{key:"render",value:function(){return Object(b.jsx)("div",{children:"Introduction is changed"})}}]),n}(a.a.Component),C=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){return Object(s.a)(this,n),t.call(this,e)}return Object(o.a)(n,[{key:"render",value:function(){return Object(b.jsx)("div",{class:"container  mx-auto px-10 sm:px-8 max-w-7xl py-10",children:Object(b.jsx)("sl-form",{children:Object(b.jsx)("sl-textarea",{rows:4})})})}}]),n}(a.a.Component),w=n(11),N=n(640),A=n(257),B=n(76),D=n(161),P=n(196);function M(){var e=a.a.useState(""),t=Object(w.a)(e,2),n=t[0],i=t[1];return Object(b.jsx)(N.a,{sx:{minWidth:120},children:Object(b.jsxs)(D.a,{fullWidth:!0,children:[Object(b.jsx)(A.a,{id:"airwaySelect",children:"Airway"}),Object(b.jsxs)(P.a,{labelId:"Airway",id:"airwaySelect",value:n,label:"Options",onChange:function(e){i(e.target.value)},children:[Object(b.jsx)(B.a,{value:10,children:"Patent"}),Object(b.jsx)(B.a,{value:20,children:"Compromised"}),Object(b.jsx)(B.a,{value:30,children:"Ventilated"})]})]})})}var F=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var i;return Object(s.a)(this,n),(i=t.call(this,e)).state={loaded:!1,error:null,responseExist:!1,patient:null,questionnaire:null,questionnaireResponse:null,isIsobar:!1,saveState:"edited",formState:"ISOBAR"},i}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.context.client}},{key:"render",value:function(){return Object(b.jsxs)("div",{className:"container  mx-auto px-10 sm:px-8 max-w-7xl py-10",children:[Object(b.jsx)("h1",{children:"Situation"}),Object(b.jsx)("h3",{children:"Patient Status"}),Object(b.jsx)(y.a,{fullWidth:!0,multiline:!0,placeholder:"Patient Status"}),Object(b.jsx)("h3",{children:"Principle Diagnosis"}),Object(b.jsx)(y.a,{fullWidth:!0,multiline:!0,placeholder:"Principle Diagnosis"}),Object(b.jsx)("h3",{children:"Other Diagnosis/problems"}),Object(b.jsx)(y.a,{fullWidth:!0,multiline:!0,placeholder:"Other Diagnosis/problems"}),Object(b.jsx)("h3",{children:"Reason For transfer"}),Object(b.jsx)(y.a,{fullWidth:!0,multiline:!0,placeholder:"Reason For transfer"}),Object(b.jsx)("h3",{children:"Observations"}),Object(b.jsx)(M,{})]})}}]),n}(a.a.Component);F.contextType=O;var T=n(345);function q(e){var t=e.name,n=void 0===t?[]:t,i=n.find((function(e){return"official"===e.use}))||n[0];return i?Object(b.jsx)("h1",{children:i.given.join(" ")+" "+i.family}):Object(b.jsx)("h1",{children:"No Name"})}function L(e){return console.log(e),Object(b.jsxs)("div",{children:[Object(b.jsx)(q,{name:e.name}),Object(b.jsxs)("span",{children:["Gender: ",Object(b.jsx)("b",{children:e.gender})," "]}),Object(b.jsxs)("span",{children:["DOB: ",Object(b.jsx)("b",{children:e.birthDate})]}),Object(b.jsxs)("span",{children:["DOB: ",Object(b.jsx)("b",{children:e.address[0].city})]})]})}var W=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var i;return Object(s.a)(this,n),(i=t.call(this,e)).state={loading:!0,patient:null,error:null},i}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.context.client;this._loader=t.patient.read().then((function(t){e.setState({patient:t,loading:!1,error:null})})).catch((function(t){e.setState({error:t,loading:!1})}))}},{key:"render",value:function(){var e=this.state,t=e.error,n=e.loading,i=e.patient;return n?null:t?t.message:Object(b.jsx)(L,Object(T.a)({},i))}}]),n}(a.a.Component);W.contextType=O;var Q=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){return Object(s.a)(this,n),t.call(this,e)}return Object(o.a)(n,[{key:"render",value:function(){return Object(b.jsxs)("div",{className:"container",children:[Object(b.jsx)(W,{}),Object(b.jsx)(R,{}),Object(b.jsx)(F,{}),Object(b.jsx)(I,{}),Object(b.jsx)(S,{}),Object(b.jsx)(C,{})]})}}]),n}(a.a.Component),U=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){return Object(s.a)(this,n),t.call(this,e)}return Object(o.a)(n,[{key:"render",value:function(){switch(this.props.current){case"I":return Object(b.jsx)(R,{});case"S":return Object(b.jsx)(F,{});case"B":return Object(b.jsx)(I,{});case"A":return Object(b.jsx)(S,{});case"R":return Object(b.jsx)(C,{});default:return Object(b.jsx)(R,{})}}}]),n}(a.a.Component);(function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var i;return Object(s.a)(this,n),(i=t.call(this,e)).state={current:"I",loaded:!1,carePlan:null},i}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.context.client;this.LoadCarePlan().then((function(t){console.log(t),e.setState({loaded:!0})}))}},{key:"LoadCarePlan",value:function(){return this.context.client.request("CarePlan?patient="+this.context.client.patient.id).then((function(e){}))}},{key:"render",value:function(){var e=this;return this.state.loaded?Object(b.jsxs)("div",{className:"app-complex",children:[Object(b.jsx)("div",{className:"app-content",children:Object(b.jsx)(U,{current:this.state.current})}),Object(b.jsxs)("div",{className:"footer",children:[Object(b.jsx)("div",{className:"arrow",children:"\u2190"}),Object(b.jsx)("button",{className:"nav-button",onClick:function(){return e.setState({current:"I"})},children:"I"}),Object(b.jsx)("button",{className:"nav-button",onClick:function(){return e.setState({current:"S"})},children:"S"}),Object(b.jsx)("button",{className:"nav-button",onClick:function(){return e.setState({current:"B"})},children:"B"}),Object(b.jsx)("button",{className:"nav-button",onClick:function(){return e.setState({current:"A"})},children:"A"}),Object(b.jsx)("button",{className:"nav-button",onClick:function(){return e.setState({current:"R"})},children:"R"}),Object(b.jsx)("div",{className:"arrow",children:"\u2192"})]})]}):Object(b.jsx)("div",{children:"Loading complex isbar form..."})}}]),n}(a.a.Component)).contextType=O;var V=n(641),E=n(634),Y=n(636),z=n(642),J=n(117),H=n(643),G=n(347),Z=n.n(G),_=n(346);function K(e){return e.prefix[0]?e.prefix[0]+" "+e.given[0]+" "+e.family:e.given[0]+" "+e.family}var X=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var i;return Object(s.a)(this,n),(i=t.call(this,e)).state={fields:[{field:"lastUpdated",headerName:"Last Updated",width:200},{field:"author",headerName:"Author",width:140},{field:"id",headerName:"ID",width:210},{field:"recipient",headerName:"Recipient",width:140},{field:"action",headerName:"Action",width:70}],entries:null},i}return Object(o.a)(n,[{key:"componentDidMount",value:function(){console.log("history"),console.log(this.props.data),this.props.data?this.updateTable():console.error("No data given to history!! did the request fail?")}},{key:"updateTable",value:function(){var e=this,t=[];0!=this.props.data.total?(this.props.data.entry.forEach((function(e){var n=e.resource,i={lastUpdated:"Loading",id:"Loading",author:"Loading",recipient:"Loading"};n.meta.hasOwnProperty("lastUpdated")&&(i.lastUpdated=function(e){var t=new Date(e);return t.getFullYear()+"-"+t.getMonth()+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()}(n.meta.lastUpdated)),n.hasOwnProperty("id")&&(i.id=n.id),n.hasOwnProperty("author")&&(i.author=K(n.author.name[0])),t.push(i)})),this.props.data.entry.forEach((function(n,i){var a=n.resource;a.hasOwnProperty("extension")&&e.context.client.request(a.extension[0].valueReference.reference).then((function(n){console.log(t[i]),t[i].recipient=K(n.name[0]),e.forceUpdate()}))}))):console.log("no existing entry"),this.setState({entries:t})}},{key:"render",value:function(){return null!=this.state.entries?Object(b.jsx)("div",{style:{height:400,width:"100%"},children:Object(b.jsx)(_.a,{rows:this.state.entries,columns:this.state.fields,pageSize:5,rowsPerPageOptions:[5],checkboxSelection:!0})}):Object(b.jsx)("div",{children:"Loading data.."})}}]),n}(a.a.Component);X.contextType=O;var $=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object(b.jsx)(x,{children:Object(b.jsx)(ee,{})})}}]),n}(a.a.Component),ee=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var i;return Object(s.a)(this,n),(i=t.call(this,e)).state={loaded:!1,isMenu:!0,isSimple:!0,questionnaireID:null,simpleResponses:null,createNew:!1},i}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.loadQuestionnaireID().then((function(t){return e.loadSimpleIsbars(t)})).then((function(){return e.setState({loaded:!0})}));this.context.client.request("Practitioner/e443ac58-8ece-4385-8d55-775c1b8f3a37").then(console.log),Promise.all([t]).then((function(){return console.log("all loaded")}))}},{key:"backToMenu",value:function(){this.setState({isMenu:!0})}},{key:"loadQuestionnaireID",value:function(){var e=this;return this.context.client.request("Questionnaire?name="+te.name).then((function(t){return 0===t.total?e.context.client.create(te):t.entry[0].resource})).then((function(t){return e.setState({questionnaireID:t.id}),t.id})).catch(console.error)}},{key:"loadSimpleIsbars",value:function(e){var t=this;return this.context.client.request("QuestionnaireResponse?questionnaire="+e+"&patient=Patient/"+this.context.client.patient.id,{resolveReferences:["author","extension[1].valueReference"]}).then((function(e){return t.setState({simpleResponses:e}),e})).catch(console.error)}},{key:"render",value:function(){var e=this;return this.state.loaded&&this.state.isMenu?Object(b.jsxs)("div",{children:[Object(b.jsxs)(N.a,{sx:{padding:"3%"},children:[Object(b.jsx)(V.a,{sx:{width:"100%",textAlign:"center",fontSize:"30px"},children:"ISBAR Handover Form"}),Object(b.jsx)(E.a,{spacing:2,sx:{},children:Object(b.jsxs)(Y.a,{defaultExpanded:!0,children:[Object(b.jsxs)(z.a,{expandIcon:Object(b.jsx)(Z.a,{}),"aria-controls":"panel1bh-content",id:"panel1bh-header",children:[Object(b.jsx)(V.a,{sx:{width:"70%",flexShrink:0},children:"Simple ISBAR handover forms"}),Object(b.jsx)(J.a,{onClick:function(){return e.setState({createNew:!0,isMenu:!1,isSimple:!0})},children:"Create new"})]}),Object(b.jsx)(H.a,{children:Object(b.jsx)(X,{data:this.state.simpleResponses})})]})})]}),Object(b.jsx)("button",{className:"main-menu-button",onClick:function(){return e.setState({isSimple:!1,isMenu:!1})},children:"Complex ISBAR"})]}):this.state.loaded&&this.state.isSimple?Object(b.jsx)(k,{goBack:this.backToMenu.bind(this),content:"content",create:this.state.createNew,questionnaireID:this.state.questionnaireID}):this.state.loaded&&!this.state.isSimple?Object(b.jsx)(Q,{}):Object(b.jsx)("div",{children:"Loading"})}}]),n}(a.a.Component);ee.contextType=O;var te={resourceType:"Questionnaire",title:"questionnaireTitle",name:"isbar-simple",status:"active",item:[{linkid:"1",text:"I:Identify",type:"text"},{linkid:"2",text:"S:Situation",type:"text"},{linkid:"3",text:"O:Observation",type:"text"},{linkid:"4",text:"B:Background",type:"text"},{linkid:"5",text:"A:Assessment",type:"text"},{linkid:"6",text:"R:Recommendation",type:"text"}]},ne=(n(574),function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object(b.jsx)(d.a,{children:Object(b.jsxs)(h.c,{children:[Object(b.jsx)(h.a,{path:"/isbar-app",component:$,exact:!0}),Object(b.jsx)(h.a,{path:"/",component:p,exact:!0})]})})}}]),n}(a.a.Component));c.a.render(Object(b.jsx)(ne,{}),document.getElementById("root"))}},[[576,1,2]]]);
//# sourceMappingURL=main.5efce61b.chunk.js.map